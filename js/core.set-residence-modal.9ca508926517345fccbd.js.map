{"version":3,"sources":["webpack:///./App/Containers/SetResidenceModal/set-residence-form.jsx","webpack:///./App/Containers/SetResidenceModal/set-residence-modal.jsx"],"names":["SetResidenceForm","class_prefix","children","header_text","errors","touched","setFieldTouched","setFieldValue","residence_list","className","localize","name","field","autoComplete","type","label","error","residence","required","list_items","onItemSelection","value","text","placeholder","use_text","onChange","e","target","propTypes","PropTypes","node","string","arrayOf","object","isResidenceText","item","values","toLowerCase","SetResidence","onSetResidenceComplete","Error","props","isModalVisible","enableApp","this","onSetResidence","initialValues","validate","index_of_selection","findIndex","disabled","website_name","validateResidence","onSubmit","modded_values","isSubmitting","classNames","is_disabled","primary","React","func","array","SetResidenceModal","disableApp","is_loading","is_visible","toggleSetResidenceModal","length","is_content_centered","bool","connect","ui","client","is_set_residence_modal_visible"],"mappings":"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","file":"js/core.set-residence-modal.9ca508926517345fccbd.js","sourcesContent":["import { Field } from 'formik';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { Autocomplete, DesktopWrapper, MobileWrapper, SelectNative } from '@deriv/components';\nimport { localize } from '@deriv/translations';\n\nconst SetResidenceForm = ({\n    class_prefix = 'set-residence',\n    children,\n    header_text,\n    errors,\n    touched,\n    setFieldTouched,\n    setFieldValue,\n    residence_list,\n}) => (\n    <div className={`${class_prefix}__residence-selection`}>\n        {!!header_text && <p className={`${class_prefix}__heading`}>{header_text}</p>}\n        <p className={`${class_prefix}__${header_text ? 'text' : 'heading'}`}>{localize('Where do you live?')}</p>\n        <Field name='residence'>\n            {({ field }) => (\n                <React.Fragment>\n                    <DesktopWrapper>\n                        <Autocomplete\n                            {...field}\n                            autoComplete='off'\n                            className={`${class_prefix}__residence-field`}\n                            type='text'\n                            label={localize('Choose country')}\n                            error={touched.residence && errors.residence}\n                            required\n                            list_items={residence_list}\n                            onItemSelection={({ value, text }) => setFieldValue('residence', value ? text : '', true)}\n                        />\n                    </DesktopWrapper>\n                    <MobileWrapper>\n                        <SelectNative\n                            placeholder={localize('Please select')}\n                            label={localize('Choose country')}\n                            value={field.value}\n                            list_items={residence_list}\n                            error={touched.residence && errors.residence}\n                            required\n                            use_text\n                            onChange={e => {\n                                setFieldTouched('residence', true);\n                                setFieldValue('residence', e.target.value, true);\n                            }}\n                        />\n                    </MobileWrapper>\n                </React.Fragment>\n            )}\n        </Field>\n        {children}\n    </div>\n);\n\nSetResidenceForm.propTypes = {\n    children: PropTypes.node,\n    class_prefix: PropTypes.string,\n    header_text: PropTypes.string,\n    residence_list: PropTypes.arrayOf(PropTypes.object),\n};\n\nexport default SetResidenceForm;\n","import classNames from 'classnames';\nimport { Formik, Form } from 'formik';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { Button, Dialog } from '@deriv/components';\nimport { localize } from '@deriv/translations';\nimport { connect } from 'Stores/connect';\nimport { website_name } from '@deriv/shared';\nimport ResidenceForm from './set-residence-form.jsx';\nimport 'Sass/app/modules/set-residence.scss';\n\n// TODO: Move some of these functions to helpers since some of them are shared with AccountSignUpModal\nconst isResidenceText = (item, values) => item.text.toLowerCase() === values.residence.toLowerCase();\n\nconst validateResidence = (values, residence_list) => {\n    const errors = {};\n\n    if (!values.residence) {\n        errors.residence = true;\n    } else {\n        const index_of_selection = residence_list.findIndex(item => isResidenceText(item, values));\n\n        if (index_of_selection === -1 || residence_list[index_of_selection].disabled === 'DISABLED') {\n            errors.residence = localize('Unfortunately, {{website_name}} is not available in your country.', {\n                website_name,\n            });\n        }\n    }\n\n    return errors;\n};\n\nclass SetResidence extends React.Component {\n    onSetResidenceComplete = error => {\n        // TODO: Proper error handling (currently we have no place to put the message)\n        if (error) {\n            throw Error(error);\n        }\n        // Handle lower level modal controls due to overriding modal rendering\n        this.props.isModalVisible(false);\n        this.props.enableApp();\n    };\n\n    render() {\n        const { onSetResidence, residence_list } = this.props;\n        const onSetResidencePassthrough = values => {\n            const index_of_selection = residence_list.findIndex(item => isResidenceText(item, values));\n            const modded_values = { ...values, residence: residence_list[index_of_selection].value };\n            onSetResidence(modded_values, this.onSetResidenceComplete);\n        };\n        return (\n            <div className='set-residence'>\n                <Formik\n                    initialValues={{ residence: '' }}\n                    validate={values => validateResidence(values, residence_list)}\n                    onSubmit={onSetResidencePassthrough}\n                >\n                    {({ isSubmitting, errors, values, setFieldValue, touched }) => (\n                        <Form>\n                            <React.Fragment>\n                                <ResidenceForm\n                                    errors={errors}\n                                    touched={touched}\n                                    setFieldValue={setFieldValue}\n                                    residence_list={residence_list}\n                                >\n                                    <p className='set-residence__subtext'>\n                                        {localize(\n                                            'We need this to make sure our service complies with laws and regulations in your country.'\n                                        )}\n                                    </p>\n                                    <Button\n                                        className={classNames('set-residence__btn', {\n                                            'set-residence__btn--disabled':\n                                                !values.residence || errors.residence || isSubmitting,\n                                        })}\n                                        type='submit'\n                                        is_disabled={!values.residence || !!errors.residence || isSubmitting}\n                                        text={localize('Set residence')}\n                                        primary\n                                    />\n                                </ResidenceForm>\n                            </React.Fragment>\n                        </Form>\n                    )}\n                </Formik>\n            </div>\n        );\n    }\n}\n\nSetResidence.propTypes = {\n    onSetResidence: PropTypes.func,\n    residence_list: PropTypes.array,\n};\n\nconst SetResidenceModal = ({\n    enableApp,\n    disableApp,\n    is_loading,\n    is_visible,\n    onSetResidence,\n    residence_list,\n    toggleSetResidenceModal,\n}) => {\n    if (residence_list.length < 1) return null;\n    return (\n        <Dialog\n            is_visible={is_visible}\n            disableApp={disableApp}\n            enableApp={enableApp}\n            is_loading={is_loading || !residence_list.length}\n            is_content_centered\n        >\n            <SetResidence\n                onSetResidence={onSetResidence}\n                residence_list={residence_list}\n                isModalVisible={toggleSetResidenceModal}\n                enableApp={enableApp}\n            />\n        </Dialog>\n    );\n};\n\nSetResidenceModal.propTypes = {\n    disableApp: PropTypes.func,\n    enableApp: PropTypes.func,\n    is_loading: PropTypes.bool,\n    is_visible: PropTypes.bool,\n    onSetResidence: PropTypes.func,\n    residence_list: PropTypes.arrayOf(PropTypes.object),\n};\n\nexport default connect(({ ui, client }) => ({\n    is_visible: ui.is_set_residence_modal_visible,\n    toggleSetResidenceModal: ui.toggleSetResidenceModal,\n    enableApp: ui.enableApp,\n    disableApp: ui.disableApp,\n    is_loading: ui.is_loading,\n    onSetResidence: client.onSetResidence,\n    residence_list: client.residence_list,\n}))(SetResidenceModal);\n"],"sourceRoot":""}